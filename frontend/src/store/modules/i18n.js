import axios from 'axios'

const API_BASE = '/api/i18n'

// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏
const SUPPORTED_LANGUAGES = {
  ru: {
    code: 'ru',
    name: '–†—É—Å—Å–∫–∏–π',
    flag: 'üá∑üá∫',
    nativeName: '–†—É—Å—Å–∫–∏–π'
  },
  en: {
    code: 'en', 
    name: 'English',
    flag: 'üá∫üá∏',
    nativeName: 'English'
  }
}

// –ë–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã (fallback)
const BASE_TRANSLATIONS = {
  ru: {
    // –û–±—â–∏–µ
    'common.loading': '–ó–∞–≥—Ä—É–∑–∫–∞...',
    'common.error': '–û—à–∏–±–∫–∞',
    'common.success': '–£—Å–ø–µ—à–Ω–æ',
    'common.save': '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å',
    'common.cancel': '–û—Ç–º–µ–Ω–∏—Ç—å',
    'common.delete': '–£–¥–∞–ª–∏—Ç—å',
    'common.edit': '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å',
    'common.close': '–ó–∞–∫—Ä—ã—Ç—å',
    'common.back': '–ù–∞–∑–∞–¥',
    'common.next': '–î–∞–ª–µ–µ',
    'common.previous': '–ü—Ä–µ–¥—ã–¥—É—â–∏–π',
    'common.submit': '–û—Ç–ø—Ä–∞–≤–∏—Ç—å',
    'common.reset': '–°–±—Ä–æ—Å–∏—Ç—å',
    'common.search': '–ü–æ–∏—Å–∫',
    'common.filter': '–§–∏–ª—å—Ç—Ä',
    'common.hint': '–ü–æ–¥—Å–∫–∞–∑–∫–∞',
    'common.example': '–ü—Ä–∏–º–µ—Ä',
    'common.recommendation': '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è',
    'common.russian': '–†—É—Å—Å–∫–∏–π',
    'common.english': 'English',
    'common.toggleTheme': 'Toggle theme',
    
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è
    'nav.home': '–ì–ª–∞–≤–Ω–∞—è',
    'nav.math': '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞',
    'nav.ktp': '–ö–¢–ü',
    'nav.mathGame': '–ü—Ä–∏–º–µ—Ä—ã –æ–Ω–ª–∞–π–Ω',
    'nav.analytics': '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞',
    'nav.profile': '–ü—Ä–æ—Ñ–∏–ª—å',
    'nav.login': '–í–æ–π—Ç–∏',
    'nav.register': '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è',
    'nav.logout': '–í—ã–π—Ç–∏',
    
    // –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    'auth.login': '–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É',
    'auth.register': '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è',
    'auth.email': '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞',
    'auth.password': '–ü–∞—Ä–æ–ª—å',
    'auth.fullName': '–ü–æ–ª–Ω–æ–µ –∏–º—è',
    'auth.school': '–®–∫–æ–ª–∞',
    'auth.forgotPassword': '–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?',
    'auth.rememberMe': '–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è',
    'auth.agreeTerms': '–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è',
    
    // –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
    'home.title': '–í–´–ë–ï–†–ò–¢–ï –ì–ï–ù–ï–†–ê–¢–û–†',
    'home.mathGenerator': 'üìä –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ü—Ä–∏–º–µ—Ä–æ–≤',
    'home.ktpGenerator': 'üìÖ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –î–∞—Ç –¥–ª—è –ö–¢–ü',
    'home.mathGame': 'üéÆ –ü—Ä–∏–º–µ—Ä—ã –æ–Ω–ª–∞–π–Ω',
    'home.advice': '–°–æ–≤–µ—Ç: –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤—ã—à–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.',
    
    // –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
    'math.title': '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤',
    'math.operations': '–û–ø–µ—Ä–∞—Ü–∏–∏',
    'math.operands': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤',
    'math.interval': '–î–∏–∞–ø–∞–∑–æ–Ω —á–∏—Å–µ–ª',
    'math.examples': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤',
    'math.generate': '–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á–∏',
    'math.operandsLabel': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤:',
    'math.operandsHint': '–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∏—Å–µ–ª –≤ –ø—Ä–∏–º–µ—Ä–µ (–æ—Ç 2 –¥–æ 5). –ù–∞–ø—Ä–∏–º–µ—Ä: –ø—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏–∏ 3 –ø–æ–ª—É—á–∏—Ç—Å—è "2 + 3 - 1 = 4"',
    'math.operationsLabel': '–û–ø–µ—Ä–∞—Ü–∏–∏:',
    'math.addition': '+ (–°–ª–æ–∂–µ–Ω–∏–µ)',
    'math.subtraction': '- (–í—ã—á–∏—Ç–∞–Ω–∏–µ)',
    'math.multiplication': '√ó (–£–º–Ω–æ–∂–µ–Ω–∏–µ)',
    'math.division': '√∑ (–î–µ–ª–µ–Ω–∏–µ)',
    'math.operationsHint': '–ü–æ–¥—Å–∫–∞–∑–∫–∞: –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö. –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ.',
    'math.intervalStart': '–ù–∞—á–∞–ª–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞:',
    'math.intervalEnd': '–ö–æ–Ω–µ—Ü –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞:',
    'math.intervalExample': '–ü—Ä–∏–º–µ—Ä –¥–∏–∞–ø–∞–∑–æ–Ω–∞: –æ—Ç 0 –¥–æ 100 ‚Äî —á–∏—Å–ª–∞ –±—É–¥—É—Ç –æ—Ç 0 –¥–æ 100 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ',
    'math.examplesLabel': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤:',
    'math.examplesHint': '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –î–ª—è –æ–¥–Ω–æ–≥–æ —É—Ä–æ–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ 10-20 –ø—Ä–∏–º–µ—Ä–æ–≤',
    'math.generateButton': 'üìÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å PDF',
    'math.generating': '‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è...',
    'math.homeButton': 'üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é',
    'math.error': '–û—à–∏–±–∫–∞:',
    'math.selectOperation': '–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é',
    'math.connectionError': '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º',
    'math.pdfError': '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF',
    'math.infoTitle': '‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ',
    'math.infoPositive': '‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã —Ç–æ–ª—å–∫–æ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏',
    'math.infoPDF': '‚Ä¢ PDF —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –≤ —Å–µ—Ç–∫–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è',
    'math.infoRandom': '‚Ä¢ –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ',
    'math.downloadModalTitle': '–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è',
    'math.downloadForStudent': 'üìö –î–ª—è —É—á–µ–Ω–∏–∫–∞',
    'math.downloadForTeacher': 'üë®‚Äçüè´ –î–ª—è —É—á–∏—Ç–µ–ª—è',
    'math.studentDescription': '–ü—Ä–∏–º–µ—Ä—ã –≤ —Å–µ—Ç–∫–µ –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤',
    'math.teacherDescription': '–ü—Ä–∏–º–µ—Ä—ã —Å –æ—Ç–≤–µ—Ç–∞–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏',
    'math.downloadButton': '–°–∫–∞—á–∞—Ç—å',
    'math.cancelButton': '–û—Ç–º–µ–Ω–∞',
    'math.downloadBoth': '–°–∫–∞—á–∞—Ç—å –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞',
    'math.downloadBothHint': '–°–∫–∞—á–∞—Ç—å PDF –¥–ª—è —É—á–µ–Ω–∏–∫–∞ –∏ —É—á–∏—Ç–µ–ª—è',
            'common.serverSupport': '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç',
    
    // –ö–¢–ü –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
    'ktp.title': '–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –ö–¢–ü',
    'ktp.startDate': '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞',
    'ktp.endDate': '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è',
    'ktp.weekdays': '–î–Ω–∏ –Ω–µ–¥–µ–ª–∏',
    'ktp.lessonsPerDay': '–£—Ä–æ–∫–æ–≤ –≤ –¥–µ–Ω—å',
    'ktp.holidays': '–ü—Ä–∞–∑–¥–Ω–∏–∫–∏',
    'ktp.generate': '–°–æ–∑–¥–∞—Ç—å –ö–¢–ü',
    'ktp.startDateLabel': '–ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞:',
    'ktp.endDateLabel': '–ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞:',
    'ktp.dateHint': '–£–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å 01.09.2024 –ø–æ 31.05.2025)',
    'ktp.weekdaysLabel': '–î–Ω–∏ –Ω–µ–¥–µ–ª–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–∫–æ–≤ –≤ –¥–µ–Ω—å:',
    'ktp.weekdaysHint': '–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ –∏ —É–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–∫–æ–≤ –≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å',
    'ktp.holidaysLabel': '–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏ (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å - –∑–∞–ø—è—Ç–∞—è):',
    'ktp.holidaysPlaceholder': '04.11.2025, 23.02.2026, 09.03.2026, 11.05.2026',
    'ktp.holidaysExample': '–ü—Ä–∏–º–µ—Ä:',
    'ktp.autumnStart': '–ù–∞—á–∞–ª–æ –æ—Å–µ–Ω–Ω–∏—Ö –∫–∞–Ω–∏–∫—É–ª:',
    'ktp.autumnEnd': '–ö–æ–Ω–µ—Ü –æ—Å–µ–Ω–Ω–∏—Ö –∫–∞–Ω–∏–∫—É–ª:',
    'ktp.winterStart': '–ù–∞—á–∞–ª–æ –∑–∏–º–Ω–∏—Ö –∫–∞–Ω–∏–∫—É–ª:',
    'ktp.winterEnd': '–ö–æ–Ω–µ—Ü –∑–∏–º–Ω–∏—Ö –∫–∞–Ω–∏–∫—É–ª:',
    'ktp.springStart': '–ù–∞—á–∞–ª–æ –≤–µ—Å–µ–Ω–Ω–∏—Ö –∫–∞–Ω–∏–∫—É–ª:',
    'ktp.springEnd': '–ö–æ–Ω–µ—Ü –≤–µ—Å–µ–Ω–Ω–∏—Ö –∫–∞–Ω–∏–∫—É–ª:',
    'ktp.lessonsPlaceholder': '–£—Ä–æ–∫–æ–≤',
    'ktp.generateButton': 'üìÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ö–¢–ü',
    'ktp.generating': '‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è...',
    'ktp.homeButton': 'üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é',
    'ktp.weekdayMonday': '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫',
    'ktp.weekdayTuesday': '–í—Ç–æ—Ä–Ω–∏–∫',
    'ktp.weekdayWednesday': '–°—Ä–µ–¥–∞',
    'ktp.weekdayThursday': '–ß–µ—Ç–≤–µ—Ä–≥',
    'ktp.weekdayFriday': '–ü—è—Ç–Ω–∏—Ü–∞',
    'ktp.weekdaySaturday': '–°—É–±–±–æ—Ç–∞',
    'ktp.weekdaySunday': '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ',
    'ktp.firstClassHolidays': '–ö–∞–Ω–∏–∫—É–ª—ã –¥–ª—è 1 –∫–ª–∞—Å—Å–æ–≤',
    'ktp.filenameLabel': '–ò–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:',
    'ktp.filenamePlaceholder': 'schedule',
    'ktp.filenameExample': '–ü—Ä–∏–º–µ—Ä: –ö–¢–ü_–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞_5–∫–ª–∞—Å—Å',
    'ktp.importantNote': '‚ö†Ô∏è –í–ê–ñ–ù–û!',
    'ktp.workdayTransfer': '',
    'ktp.workdayTransferHint': '–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ, —á—Ç–æ –µ—Å—Ç—å –¥–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–æ–≥–¥–∞ –≤—Ç–æ—Ä–Ω–∏–∫, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ–º –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫—É.',
    'ktp.generatorInfo': '‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ',
    'ktp.generatorInfo1': '‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ-—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ Excel',
    'ktp.generatorInfo2': '‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ –∫–∞–Ω–∏–∫—É–ª—ã',
    'ktp.generatorInfo3': '‚Ä¢ –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–∫–æ–≤ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏',
    'ktp.generatorInfo4': '‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∏–∫—É–ª—ã –¥–ª—è 1 –∫–ª–∞—Å—Å–æ–≤',
    'ktp.generatorInfo5': '‚Ä¢ –§–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ —Ñ–∞–π–ª–µ: –î–î.–ú–ú –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞',
    'ktp.firstGradeStart': '–ù–∞—á–∞–ª–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–Ω–∏–∫—É–ª –¥–ª—è 1 –∫–ª–∞—Å—Å–æ–≤:',
    'ktp.firstGradeEnd': '–ö–æ–Ω–µ—Ü –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–Ω–∏–∫—É–ª –¥–ª—è 1 –∫–ª–∞—Å—Å–æ–≤:',
    'ktp.firstGradeHint': '–û–±—ã—á–Ω–æ: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∏–∫—É–ª—ã –¥–ª—è 1 –∫–ª–∞—Å—Å–æ–≤ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –≤ —Ñ–µ–≤—Ä–∞–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å 16.02 –ø–æ 22.02)',
    'ktp.selectWeekdayError': '–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏',
    'ktp.holidaysHint': '–£–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–∏–æ–¥—ã –∫–∞–Ω–∏–∫—É–ª. –≠—Ç–∏ –¥–Ω–∏ –±—É–¥—É—Ç –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è',
    
    // –ü—Ä–æ—Ñ–∏–ª—å
    'profile.title': '–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    'profile.stats': '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
    'profile.activity': '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
    'profile.edit': '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å',
    'profile.changePassword': '–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å',
    
    // –û—à–∏–±–∫–∏
    'error.general': '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞',
    'error.network': '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏',
    'error.validation': '–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏',
    'error.auth': '–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏',
    'error.permission': '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤'
  },
  
  en: {
    // Common
    'common.loading': 'Loading...',
    'common.error': 'Error',
    'common.success': 'Success',
    'common.save': 'Save',
    'common.cancel': 'Cancel',
    'common.delete': 'Delete',
    'common.edit': 'Edit',
    'common.close': 'Close',
    'common.back': 'Back',
    'common.next': 'Next',
    'common.previous': 'Previous',
    'common.submit': 'Submit',
    'common.reset': 'Reset',
    'common.search': 'Search',
    'common.filter': 'Filter',
    'common.hint': 'Hint',
    'common.example': 'Example',
    'common.recommendation': 'Recommendation',
    'common.russian': '–†—É—Å—Å–∫–∏–π',
    'common.english': 'English',
    
    // Navigation
    'nav.home': 'Home',
    'nav.math': 'Math',
    'nav.ktp': 'LTP',
    'nav.mathGame': 'Online Examples',
    'nav.analytics': 'Analytics',
    'nav.profile': 'Profile',
    'nav.login': 'Login',
    'nav.register': 'Register',
    'nav.logout': 'Logout',
    
    // Authentication
    'auth.login': 'Login',
    'auth.register': 'Registration',
    'auth.email': 'Email',
    'auth.password': 'Password',
    'auth.fullName': 'Full Name',
    'auth.school': 'School',
    'auth.forgotPassword': 'Forgot Password?',
    'auth.rememberMe': 'Remember Me',
    'auth.agreeTerms': 'I agree to the terms of use',
    
    // Home Page
    'home.title': 'SELECT GENERATOR',
    'home.mathGenerator': 'üìä Math Problems Generator',
    'home.ktpGenerator': 'üìÖ LTP Date Generator',
    'home.mathGame': 'üéÆ Online Examples',
    'home.advice': 'Tip: Select the generator above to create educational materials.',
    
    // Math Generator
    'math.title': 'Math Problems Generator',
    'math.operations': 'Operations',
    'math.operands': 'Number of Operands',
    'math.interval': 'Number Range',
    'math.examples': 'Number of Examples',
    'math.generate': 'Generate Problems',
    'math.operandsLabel': 'Number of operands:',
    'math.operandsHint': 'Hint: Number of numbers in the example (from 2 to 5). For example: with value 3 you will get "2 + 3 - 1 = 4"',
    'math.operationsLabel': 'Operations:',
    'math.addition': '+ (Addition)',
    'math.subtraction': '- (Subtraction)',
    'math.multiplication': '√ó (Multiplication)',
    'math.division': '√∑ (Division)',
    'math.operationsHint': 'Hint: Select operations that will be used in examples. You can select several.',
    'math.intervalStart': 'Range start:',
    'math.intervalEnd': 'Range end:',
    'math.intervalExample': 'Range example: from 0 to 100 ‚Äî numbers will be from 0 to 100 inclusive',
    'math.examplesLabel': 'Number of examples:',
    'math.examplesHint': 'Recommendation: For one lesson, 10-20 examples are optimal',
    'math.generateButton': 'üìÑ Generate PDF',
    'math.generating': '‚è≥ Generating...',
    'math.homeButton': 'üè† Home',
    'math.error': 'Error:',
    'math.selectOperation': 'Select at least one operation',
    'math.connectionError': 'Server connection error',
    'math.pdfError': 'PDF generation error',
    'math.infoTitle': '‚ÑπÔ∏è Generator Information',
    'math.infoPositive': '‚Ä¢ Generator creates math examples with positive results only',
    'math.infoPDF': '‚Ä¢ PDF file will contain examples in grid for solving',
    'math.infoRandom': '‚Ä¢ All examples are generated randomly in the specified range',
    'math.downloadModalTitle': 'Select download option',
    'math.downloadForStudent': 'üìö For Student',
    'math.downloadForTeacher': 'üë®‚Äçüè´ For Teacher',
    'math.studentDescription': 'Examples in grid without answers',
    'math.teacherDescription': 'Examples with answers for checking',
    'math.downloadButton': 'Download',
    'math.cancelButton': 'Cancel',
    'math.downloadBoth': 'Download Both',
    'math.downloadBothHint': 'Download PDF for student and teacher',
            'common.serverSupport': 'Support the project',
    
    // LTP Generator
    'ktp.title': 'LTP Generator',
    'ktp.startDate': 'Start Date',
    'ktp.endDate': 'End Date',
    'ktp.weekdays': 'Weekdays',
    'ktp.lessonsPerDay': 'Lessons per Day',
    'ktp.holidays': 'Holidays',
    'ktp.generate': 'Generate LTP',
    'ktp.startDateLabel': 'Start date:',
    'ktp.endDateLabel': 'End date:',
    'ktp.dateHint': 'Hint: Specify the academic year period (e.g., from 01.09.2024 to 31.05.2025)',
    'ktp.weekdaysLabel': 'Weekdays and number of lessons per day:',
    'ktp.weekdaysHint': 'Hint: Select working weekdays and specify the number of lessons for each day',
    'ktp.holidaysLabel': 'Holidays (separator - comma):',
    'ktp.holidaysPlaceholder': '04.11.2025, 23.02.2026, 09.03.2026, 11.05.2026',
    'ktp.holidaysExample': 'Example:',
    'ktp.autumnStart': 'Autumn holidays start:',
    'ktp.autumnEnd': 'Autumn holidays end:',
    'ktp.winterStart': 'Winter holidays start:',
    'ktp.winterEnd': 'Winter holidays end:',
    'ktp.springStart': 'Spring holidays start:',
    'ktp.springEnd': 'Spring holidays end:',
    'ktp.lessonsPlaceholder': 'Lessons',
    'ktp.generateButton': 'üìÑ Generate LTP',
    'ktp.generating': '‚è≥ Generating...',
    'ktp.homeButton': 'üè† Home',
    'ktp.weekdayMonday': 'Monday',
    'ktp.weekdayTuesday': 'Tuesday',
    'ktp.weekdayWednesday': 'Wednesday',
    'ktp.weekdayThursday': 'Thursday',
    'ktp.weekdayFriday': 'Friday',
    'ktp.weekdaySaturday': 'Saturday',
    'ktp.weekdaySunday': 'Sunday',
    'ktp.firstClassHolidays': 'Holidays for 1st grade',
    'ktp.filenameLabel': 'Filename for saving:',
    'ktp.filenamePlaceholder': 'schedule',
    'ktp.filenameExample': 'Example: LTP_math_5grade',
    'ktp.importantNote': '‚ö†Ô∏è IMPORTANT! DATES THAT NEED TO BE EDITED MANUALLY',
    'ktp.workdayTransfer': '28.12.2024 Saturday - working on Tuesday',
    'ktp.workdayTransferHint': 'Don\'t forget that there are dates that need to be edited manually, for example when it\'s Tuesday but we work on Monday.',
    'ktp.generatorInfo': '‚ÑπÔ∏è Generator Information',
    'ktp.generatorInfo1': '‚Ä¢ Generator creates calendar-thematic planning in Excel format',
    'ktp.generatorInfo2': '‚Ä¢ Automatically excludes holidays and vacations',
    'ktp.generatorInfo3': '‚Ä¢ Considers the number of lessons per weekday',
    'ktp.generatorInfo4': '‚Ä¢ Supports additional holidays for 1st grade',
    'ktp.generatorInfo5': '‚Ä¢ Date format in file: DD.MM for convenience',
    'ktp.firstGradeStart': 'Start of additional holidays for 1st grade:',
    'ktp.firstGradeEnd': 'End of additional holidays for 1st grade:',
    'ktp.firstGradeHint': 'Usually: additional holidays for 1st grade are held in February (e.g., from 14.02 to 20.02)',
    'ktp.selectWeekdayError': 'Select at least one weekday',
    'ktp.holidaysHint': 'Specify vacation periods. These days will be excluded from the schedule',
    
    // Profile
    'profile.title': 'User Profile',
    'profile.stats': 'Statistics',
    'profile.activity': 'Activity',
    'profile.edit': 'Edit Profile',
    'profile.changePassword': 'Change Password',
    
    // Errors
    'error.general': 'An error occurred',
    'error.network': 'Network error',
    'error.validation': 'Validation error',
    'error.auth': 'Authentication error',
    'error.permission': 'Permission denied'
  }
}

// –°–æ—Å—Ç–æ—è–Ω–∏–µ i18n
const state = {
  // –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
  currentLanguage: 'ru',
  
  // –î–æ—Å—Ç—É–ø–Ω—ã–µ —è–∑—ã–∫–∏
  availableLanguages: SUPPORTED_LANGUAGES,
  
  // –ü–µ—Ä–µ–≤–æ–¥—ã
  translations: BASE_TRANSLATIONS,
  
  // –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã —Å —Å–µ—Ä–≤–µ—Ä–∞
  serverTranslations: {},
  
  // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
  isLoading: false,
  error: null,
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
  locale: {
    dateFormat: 'DD.MM.YYYY',
    timeFormat: '24',
    numberFormat: 'ru-RU',
    currency: 'RUB'
  }
}

// –ú—É—Ç–∞—Ü–∏–∏
const mutations = {
  SET_LOADING(state, loading) {
    state.isLoading = loading
  },
  
  SET_ERROR(state, error) {
    state.error = error
  },
  
  SET_CURRENT_LANGUAGE(state, language) {
    state.currentLanguage = language
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —è–∑—ã–∫–∞
    switch (language) {
      case 'en':
        state.locale = {
          dateFormat: 'MM/DD/YYYY',
          timeFormat: '12',
          numberFormat: 'en-US',
          currency: 'USD'
        }
        break
      case 'kk':
        state.locale = {
          dateFormat: 'DD.MM.YYYY',
          timeFormat: '24',
          numberFormat: 'kk-KZ',
          currency: 'KZT'
        }
        break
      case 'be':
      case 'uk':
        state.locale = {
          dateFormat: 'DD.MM.YYYY',
          timeFormat: '24',
          numberFormat: 'ru-RU',
          currency: 'BYN'
        }
        break
      default: // ru
        state.locale = {
          dateFormat: 'DD.MM.YYYY',
          timeFormat: '24',
          numberFormat: 'ru-RU',
          currency: 'RUB'
        }
    }
  },
  
  SET_TRANSLATIONS(state, { language, translations }) {
    state.serverTranslations[language] = translations
    
    // –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –±–∞–∑–æ–≤—ã–º–∏ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏
    if (state.translations[language]) {
      state.translations[language] = {
        ...state.translations[language],
        ...translations
      }
    } else {
      state.translations[language] = translations
    }
  },
  
  CLEAR_ERROR(state) {
    state.error = null
  }
}

// –î–µ–π—Å—Ç–≤–∏—è
const actions = {
  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —è–∑—ã–∫–∞
  async setLanguage({ commit, dispatch }, language) {
    if (!SUPPORTED_LANGUAGES[language]) {
      throw new Error(`Unsupported language: ${language}`)
    }
    
    try {
      commit('SET_LOADING', true)
      commit('CLEAR_ERROR')
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —è–∑—ã–∫
      commit('SET_CURRENT_LANGUAGE', language)
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
      localStorage.setItem('selected_language', language)
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã —Å —Å–µ—Ä–≤–µ—Ä–∞ –µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç
      if (!state.serverTranslations[language]) {
        await dispatch('loadTranslations', language)
      }
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —è–∑—ã–∫–∞ —Å–µ—Å—Å–∏–∏
      try {
        await axios.post(`${API_BASE}/set-language`, { language })
      } catch (error) {
        console.warn('Failed to set server language:', error)
      }
      
    } catch (error) {
      const errorMessage = error.response?.data?.detail || '–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —è–∑—ã–∫–∞'
      commit('SET_ERROR', errorMessage)
      throw error
    } finally {
      commit('SET_LOADING', false)
    }
  },
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞
  async loadTranslations({ commit }, language) {
    try {
      const response = await axios.get(`${API_BASE}/translations/${language}`)
      commit('SET_TRANSLATIONS', { language, translations: response.data })
    } catch (error) {
      console.warn(`Failed to load translations for ${language}:`, error)
      // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–µ
    }
  },
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–∑—ã–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  async initializeLanguage({ commit, dispatch }) {
    try {
      // –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —è–∑—ã–∫ –∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞
      const savedLanguage = localStorage.getItem('selected_language')
      const browserLanguage = navigator.language.split('-')[0]
      
      let language = savedLanguage
      if (!language && Object.keys(SUPPORTED_LANGUAGES).includes(browserLanguage)) {
        language = browserLanguage
      }
      if (!language) {
        language = 'ru' // –Ø–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      }
      
      await dispatch('setLanguage', language)
      
    } catch (error) {
      console.warn('Language initialization failed:', error)
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä—É—Å—Å–∫–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –æ—à–∏–±–∫–µ
      commit('SET_CURRENT_LANGUAGE', 'ru')
    }
  },
  
  // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è –≤—Å–µ—Ö —è–∑—ã–∫–æ–≤
  async preloadAllTranslations({ dispatch }) {
    const languages = Object.keys(SUPPORTED_LANGUAGES)
    
    try {
      await Promise.allSettled(
        languages.map(lang => dispatch('loadTranslations', lang))
      )
    } catch (error) {
      console.warn('Failed to preload translations:', error)
    }
  },
  
  // –û—á–∏—Å—Ç–∫–∞ –æ—à–∏–±–æ–∫
  clearError({ commit }) {
    commit('CLEAR_ERROR')
  }
}

// –ì–µ—Ç—Ç–µ—Ä—ã
const getters = {
  isLoading: state => state.isLoading,
  error: state => state.error,
  hasError: state => !!state.error,
  
  // –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
  currentLanguage: state => state.currentLanguage,
  currentLanguageInfo: state => SUPPORTED_LANGUAGES[state.currentLanguage],
  getCurrentLanguage: state => state.currentLanguage,
  
  // –î–æ—Å—Ç—É–ø–Ω—ã–µ —è–∑—ã–∫–∏
  availableLanguages: state => Object.values(state.availableLanguages),
  supportedLanguageCodes: state => Object.keys(state.availableLanguages),
  
  // –ü–µ—Ä–µ–≤–æ–¥—ã
  translations: state => {
    const currentLang = state.currentLanguage
    const translations = state.translations[currentLang] || state.translations['ru'] || {}
    return translations
  },
  
  // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞
  t: (state) => (key, params = {}) => {
    const translations = state.translations[state.currentLanguage] || state.translations['ru'] || {}
    let text = translations[key] || key
    
    // –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    Object.keys(params).forEach(param => {
      text = text.replace(new RegExp(`{${param}}`, 'g'), params[param])
    })
    
    return text
  },
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
  locale: state => state.locale,
  dateFormat: state => state.locale.dateFormat,
  timeFormat: state => state.locale.timeFormat,
  numberFormat: state => state.locale.numberFormat,
  currency: state => state.locale.currency,
  
  // –ü–æ–º–æ—â–Ω–∏–∫–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  formatDate: (state) => (date) => {
    if (!date) return ''
    const options = {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit'
    }
    return new Date(date).toLocaleDateString(state.locale.numberFormat, options)
  },
  
  formatDateTime: (state) => (date) => {
    if (!date) return ''
    const options = {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit'
    }
    return new Date(date).toLocaleDateString(state.locale.numberFormat, options)
  },
  
  formatNumber: (state) => (number) => {
    if (number === null || number === undefined) return ''
    return new Intl.NumberFormat(state.locale.numberFormat).format(number)
  },
  
  formatCurrency: (state) => (amount) => {
    if (amount === null || amount === undefined) return ''
    return new Intl.NumberFormat(state.locale.numberFormat, {
      style: 'currency',
      currency: state.locale.currency
    }).format(amount)
  },
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∏ RTL/LTR
  isRTL: (state) => {
    const rtlLanguages = ['ar', 'he', 'fa']
    return rtlLanguages.includes(state.currentLanguage)
  },
  
  textDirection: (state, getters) => getters.isRTL ? 'rtl' : 'ltr'
}

export default {
  namespaced: true,
  state,
  mutations,
  actions,
  getters
} 